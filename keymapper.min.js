Array.prototype.indexOf||(Array.prototype.indexOf=function(e){"use strict";if(this===null)throw new TypeError;var t=Object(this),n=t.length>>>0;if(n===0)return-1;var r=0;arguments.length>0&&(r=Number(arguments[1]),r!=r?r=0:r!==0&&r!=Infinity&&r!=-Infinity&&(r=(r>0||-1)*Math.floor(Math.abs(r))));if(r>=n)return-1;var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++)if(i in t&&t[i]===e)return i;return-1}),function(e){Array.prototype.compare=function(e){if(this.length!=e.length)return!1;var t=!0,n=this.length,r=0;for(r;r<n;r++)if(e.indexOf(this[r])==-1){t=!1;break}return t},Array.prototype.keyify=function(t){t=typeof t=="boolean"?t:!1;var n=[],r=0,i=this.length;for(r;r<i;r++)t?n.push(this[r].toString()):n.push(e.keys.reverse(this[r]).toString());return n.sort().join("_")},e.keys={map:function(e){return typeof this.l[e]=="undefined"?!1:this.l[e]},reverse:function(e){return typeof this.r[e]=="undefined"?!1:this.r[e]},active:!1,command_active:!1,l:{13:"enter",16:"shift",17:"control",18:"option",27:"escape",32:"space",37:"left",38:"up",39:"right",40:"down",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",91:"command",93:"rcommand",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",187:"plus",188:"comma",189:"minus",190:"period",191:"slash",192:"tilde",219:"left bracket",220:"backslash",221:"right bracket"},r:{enter:13,shift:16,control:17,option:18,escape:27,space:32,left:37,up:38,right:39,down:40,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,command:91,rcommand:93,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,plus:187,comma:188,minus:189,period:190,slash:191,tilde:192,"left bracket":219,backslash:220,"right bracket":221},a:[],c:{}},e.fn.keymapper=function(t,n,r){t=typeof t=="object"||typeof t=="array"?t:[t],event_key=t.keyify(),n=typeof n=="function"?n:function(){},r=typeof r=="function"?r:function(){},e.keys.c[event_key]={down:n,up:r};var i=typeof e._data(e(this).get(0),"events")!="undefined"?e._data(e(this).get(0),"events"):{},s=typeof i.keydown!="undefined"?i.keydown:[],o=!0,u=0,a=s.length;for(u;u<a;u++)if(s[u].namespace=="keymapper"){o=!1;break}o&&(e(this).on("keydown.keymapper",function(t){var n=t.which==e.keys.r.rcommand?e.keys.r.command:t.which,r=!1,i=[];e.keys.a.indexOf(n)==-1&&e.keys.a.push(n),r=e.keys.a.keyify(!0),e.keys.command_active=e.keys.a.indexOf(e.keys.r.command)!==-1,e.each(r.split("_"),function(e,t){i.push(parseInt(t,10))}),!e.keys.active&&typeof e.keys.c[r]!="undefined"&&e.keys.a.compare(i)&&(t.preventDefault(),e.keys.active=!0,e.keys.c[r].down())}),e(this).on("keyup.keymapper",function(t){var n=e.keys.a.indexOf(t.which),r=e.keys.a.keyify(!0);n!==-1&&e.keys.a.splice(n,1),e.keys.active&&(e.keys.command_active&&(e.keys.a=[],e.keys.command_active=!1),e.keys.active=!1,typeof e.keys.c[r]!==undefined&&e.keys.c[r].up())}))}}(jQuery);